/**
* author: Darshika
* Question Link: https://leetcode.com/problems/cherry-pickup-ii/
* Time Complexity: O(9*m*n*n)
* Space Complexity: O(m*n*n)
*/

class Solution {
    public int cherryPickup(int[][] grid) {
        
        int m = grid.length;
        int n = grid[0].length;
        int[][][] dp = new int[m][n][n];
        
        return dfs(0,0,n-1,dp,grid);
    }
    private int dfs(int row, int col1, int col2, int[][][] dp, int[][] grid){
        
        if(col1 < 0 || col2 < 0 || col1 >= grid[0].length || col2 >= grid[0].length){
            return 0;
        }        
        if(row == dp.length){
            return 0;
        }
        if(dp[row][col1][col2] > 0){
            return dp[row][col1][col2];
        }
        int ans = 0;
        for(int i = -1;i<=1;i++){
            for(int j = -1;j<=1;j++){
                ans = Math.max(ans, dfs(row+1,col1+i,col2+j,dp,grid));
            }
        }
        ans += (col1 == col2) ? grid[row][col1] : grid[row][col1] + grid[row][col2];
        dp[row][col1][col2] = ans;
        return dp[row][col1][col2];
    }
}
